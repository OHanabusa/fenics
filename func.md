# FEniCS における計算式と得られる形状

## **1. スカラー (`a`), ベクトル (`v`), 行列 (`M`) の定義**
- スカラー: $ a, b, c $  （例: `Constant(1.0)`, `FunctionSpace` 内の `Function`）
- ベクトル: $ v, w $  （例: `VectorFunctionSpace` の `Function`）
- 行列: $ M, K $  （例: `assemble()` で生成された `PETScMatrix`）

---

## **2. 計算式と得られる形状**

| **計算式** | **数式表現** | **得られる形状** | **説明** |
|------------|------------|--------------|--------------|
| `a * b` | $ \(a cdot b \)$ | スカラー | スカラー同士の積 |
| `a * v` | $ a v $ | ベクトル | スカラーとベクトルの積 |
| `a * M` | $ a M $ | 行列 | スカラーと行列の積 |
| `v + w` | $ v + w $ | ベクトル | ベクトルの加算 |
| `v - w` | $ v - w $ | ベクトル | ベクトルの減算 |
| `dot(v, w)` | $ v cdot w $ | スカラー | ベクトルの内積 |
| `cross(v, w)` | $ v times w $ | ベクトル | ベクトルの外積 (3D のみ) |
| `inner(v, w)` | $ v^T w $ | スカラー | ベクトルの内積（`dot()` と同じ） |
| `M * v` | $ M v $ | ベクトル | 行列とベクトルの積 |
| `M * M` | $ M M $ | 行列 | 行列同士の積 |
| `v.T * M` | $ v^T M $ | ベクトル | ベクトルの転置と行列の積 |
| `v.T * w` | $ v^T w $ | スカラー | ベクトルの転置とベクトルの積 |
| `inv(M)` | $ M^{-1} $ | 行列 | 行列の逆行列（`solve()` で解く） |
| `tr(M)` | $ text{tr}(M) $ | スカラー | 行列のトレース |
| `det(M)` | $ det(M) $ | スカラー | 行列の行列式 |
| `norm(v, "l2")` | $ | v |_2 $ | スカラー | ベクトルの L2 ノルム |
| `norm(M, "frobenius")` | $ | M |_F $ | スカラー | 行列のフロベニウスノルム |

---

## **3. 補足**
- `dot(v, w)` と `inner(v, w)` は **スカラーを返す** 。
- `M * v` は **ベクトルを返す** 。
- `M * M` は **行列を返す** 。
- `cross(v, w)` は **3D のみで有効** 。
- `inv(M)` は **直接計算するのではなく、`solve(A, x, b)` を使用するのが推奨** 。

---
